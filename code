using System;
using System.Collections.Generic;

namespace ConsoleApp14
{
    internal class Program
    {
        static void Main(string[] args)
        {
            BattleField battleField = new BattleField();

            battleField.MakeBattle();
        }
    }

    class Platoon
    {
        private List<Soldier> _soldiers = new List<Soldier>();
        public int Id { get; private set; }

        public Platoon(int id)
        {
            Id = id;
        }

        public void CreateSoldiers()
        {
            int randomNumber;
            int minimalRandomHp = 80;
            int maximalRandomHp = 120;
            int minimalNumberOfSoldiers = 20;
            int maximalNumberOfSoldiers = 30;
            int randomHp;
            int minimalRandomDamage = 8;
            int maximalRandomDamage = 15;
            int randomDamage;

            randomNumber = UserUtils.GenerateRandomNumber(minimalNumberOfSoldiers, maximalNumberOfSoldiers);

            for (int i = 0; i < randomNumber; i++)
            {
                randomHp = UserUtils.GenerateRandomNumber(minimalRandomHp, maximalRandomHp);
                randomDamage = UserUtils.GenerateRandomNumber(minimalRandomDamage, maximalRandomDamage);

                Soldier soldier = new Soldier(randomHp, randomDamage);

                _soldiers.Add(soldier);
            }
        }

        public List<Soldier> ReturnSoldiers()
        {
            List<Soldier> soldiers = _soldiers;
            return soldiers;
        }
    }

    class Soldier
    {
        public Soldier(int health, int damage)
        {
            Health = health;
            Damage = damage;
        }

        public int Health { get; private set; }
        public int Damage { get; private set; }

        public void TakeDamage(int damage)
        {
            Health -= damage;
        }

        public void Attack(Soldier soldier, int damage, Platoon platoon1, Platoon platoon2, int pickedRandomSoldier2, int pickedRandomSoldier1)
        {
            soldier.TakeDamage(damage);

            Console.WriteLine("Боец из взвода " + platoon2.Id + " нанёс бойцу из взвода " + platoon1.Id + " "+ platoon2.ReturnSoldiers()[pickedRandomSoldier2].Damage + " урона");
            Console.WriteLine("У бойца первого взвода осталось " + platoon1.ReturnSoldiers()[pickedRandomSoldier1].Health + " Жизней");
        }
    }

    class BattleField
    {
        private Platoon _platoon1 = new Platoon(1);
        private Platoon _platoon2 = new Platoon(2);

        public void MakeBattle()
        {
            int pickedRandomSoldier1 = 0;
            int pickedRandomSoldier2 = 0;

            _platoon1.CreateSoldiers();
            _platoon2.CreateSoldiers();

            while (_platoon1.ReturnSoldiers().Count > 0 && _platoon2.ReturnSoldiers().Count > 0)
            {                
                pickedRandomSoldier1 = UserUtils.GenerateRandomNumber(0, _platoon1.ReturnSoldiers().Count - 1);
                pickedRandomSoldier2 = UserUtils.GenerateRandomNumber(0, _platoon2.ReturnSoldiers().Count - 1);                

                _platoon1.ReturnSoldiers()[pickedRandomSoldier1].Attack(_platoon2.ReturnSoldiers()[pickedRandomSoldier2], _platoon1.ReturnSoldiers()[pickedRandomSoldier1].Damage, _platoon2, _platoon1, pickedRandomSoldier2, pickedRandomSoldier1);
                
                _platoon2.ReturnSoldiers()[pickedRandomSoldier2].Attack(_platoon1.ReturnSoldiers()[pickedRandomSoldier1], _platoon2.ReturnSoldiers()[pickedRandomSoldier2].Damage, _platoon1, _platoon2, pickedRandomSoldier1, pickedRandomSoldier2);
               
                if (_platoon1.ReturnSoldiers()[pickedRandomSoldier1].Health <= 0)
                {
                    Console.WriteLine("Боец первого взвода погиб");
                    _platoon1.ReturnSoldiers().Remove(_platoon1.ReturnSoldiers()[pickedRandomSoldier1]);
                }

                if (_platoon2.ReturnSoldiers()[pickedRandomSoldier2].Health <= 0)
                {
                    Console.WriteLine("Боец второго взвода погиб");
                    _platoon2.ReturnSoldiers().Remove(_platoon2.ReturnSoldiers()[pickedRandomSoldier2]);
                }
            }

            if (_platoon1.ReturnSoldiers().Count != 0)
            {
                Console.WriteLine("Победил первый взвод!");
            }
            else if (_platoon2.ReturnSoldiers().Count != 0)
            {
                Console.WriteLine("Победил второй взвод!");
            }
        }
    }

    class UserUtils
    {
        public static int GenerateRandomNumber(int minimalNumber, int maximalNumber)
        {
            int number;
            Random random = new Random();

            number = random.Next(minimalNumber, maximalNumber);
            return number;
        }
    }
}
